{
 "properties": {
  "displayName": "CIS_1_3_MCCU_LEVEL_1",
  "policyType": "Custom",
  "description": "The inititive assist with conforming an Azure environment to CIS Benchmark 1.3 Level 1.",
  "metadata": {
   "category": "Regulatory Compliance",
   "version": "1",
   "createdBy": "5d85dd14-5bb6-41e5-8cf6-7d9ae963eb58",
   "createdOn": "2021-03-01T16:22:23.985114Z",
   "updatedBy": "5d85dd14-5bb6-41e5-8cf6-7d9ae963eb58",
   "updatedOn": "2021-03-05T19:53:52.9042018Z",
   "parameterScopes": {
    "listOfLocations": "/providers/Microsoft.Management/managementGroups/CCL_FTSC"
   }
  },
  "parameters": {},
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "MFA should be enabled accounts with write permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled on accounts with owner permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled on accounts with read permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "External accounts with write permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "External accounts with read permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "External accounts with owner permissions should be removed from your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Adaptive application controls for defining safe applications should be enabled on your machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports should be closed on your virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Auto provisioning of the Log Analytics agent should be enabled on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Key Vault should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for App Service should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Storage should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for servers should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Kubernetes should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/523b5cd1-3e23-492f-a539-13118b6d1e3a",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for SQL servers on machines should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Azure SQL Database servers should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for container registries should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c25d9a16-bc35-4e15-a7e5-9db606bf9ed4",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Subscriptions should have a contact email address for security issues_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Email notification to subscription owner for high severity alerts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Email notification for high severity alerts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Secure transfer to storage accounts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Storage account public access should be disallowed_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Auditing on SQL server should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "SQL servers should be configured with 90 days auditing retention or higher_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Log checkpoints should be enabled for PostgreSQL database servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e43d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Log connections should be enabled for PostgreSQL database servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e442",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Disconnections should be logged for PostgreSQL database servers._1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e446",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Connection throttling should be enabled for PostgreSQL database servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5345bb39-67dc-4960-a1bf-427e16b9a0bd",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Log duration should be enabled for PostgreSQL database servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e8f3",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "An Azure Active Directory administrator should be provisioned for SQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure subscriptions should have a log profile for Activity Log_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7796937f-307b-4598-941c-67d3a05ebfe7",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Resource logs in Key Vault should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "An activity log alert should exist for specific Security operations_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3b980d31-7904-4bb7-8575-5665739a8052",
    "parameters": {
     "operationName": {
      "value": "Microsoft.Security/policies/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "An activity log alert should exist for specific Policy operations_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c5447c04-a4d7-4ba8-a263-c9ee321a6858",
    "parameters": {
     "operationName": {
      "value": "Microsoft.Authorization/policyAssignments/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity log should be retained for at least one year_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b02aacc0-b073-424e-8298-42b22829ee0a",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "An activity log alert should exist for specific Administrative operations_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a",
    "parameters": {
     "operationName": {
      "value": "Microsoft.Sql/servers/firewallRules/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "RDP access from the Internet should be blocked_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e372f825-a257-4fb8-9175-797a8a8627d6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "SSH access from the Internet should be blocked_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Network Watcher should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
    "parameters": {
     "listOfLocations": {
      "value": [
       "northcentralus",
       "southcentralus"
      ]
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Disk encryption should be applied on virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Monitor missing Endpoint Protection in Azure Security Center_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Key Vault keys should have an expiration date_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Key Vault secrets should have an expiration date_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Role-Based Access Control (RBAC) should be used on Kubernetes Services_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Web Application should only be accessible over HTTPS_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Latest TLS version should be used in your Web App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Latest TLS version should be used in your Function App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Latest TLS version should be used in your API App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'PHP version' is the latest, if used as a part of the API app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'Java version' is the latest, if used as a part of the Web app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/496223c3-ad65-4ecd-878a-bae78737e9ed",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'Python version' is the latest, if used as a part of the Web app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7008174a-fd10-4ef0-817e-fc820a951d73",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'Python version' is the latest, if used as a part of the Function app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7238174a-fd10-4ef0-817e-fc820a951d73",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'PHP version' is the latest, if used as a part of the WEB app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7261b898-8a84-4db8-9e04-18527132abb3",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'Python version' is the latest, if used as a part of the API app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c3584d-afae-46f7-a20a-6f8adba71a16",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'Java version' is the latest, if used as a part of the API app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88999f4c-376a-45c8-bcb3-4058f713cf39",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'HTTP Version' is the latest, if used to run the Web app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c122334-9d20-4eb8-89ea-ac9a705b74ae",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'HTTP Version' is the latest, if used to run the API app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/991310cd-e9f3-47bc-b7b6-f57b557d07db",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'Java version' is the latest, if used as a part of the Function app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Ensure that 'HTTP Version' is the latest, if used to run the Function app_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e2c1c086-2d84-4019-bff3-c44ccd95113c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "FTPS only should be required in your Function App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "FTPS should be required in your Web App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "FTPS only should be required in your API App_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9a1b8c48-453a-4044-86c3-d8bfd823e4f5",
    "parameters": {},
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/providers/Microsoft.Management/managementGroups/CCL_FTSC/providers/Microsoft.Authorization/policySetDefinitions/65b8d4986ba44962ac35b690",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "65b8d4986ba44962ac35b690"
}